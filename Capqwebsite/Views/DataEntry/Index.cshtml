<!-- Page Header Start -->
@*@model  EF.Models.WebsiteTypeDetail *@
@model List<EF.Models.WebsiteTypeDetail>
<div class="container-fluid py-1">
    <div class="container py-2">
        <div class="row align-items-center py-4">
            <div class="col-md-6 text-center text-md-right">
                <i class="fas fa-add icon-style"></i>
                <h3 class="mb-4 mb-md-0 text-primary text-uppercase output"> اضافة  @(ViewBag.TypeAr ?? "Not specified") </h3>
            </div>
            <div class="col-md-6 text-center text-md-left">
                <div class="d-inline-flex align-items-center">
                    <a class="btn btn-secondary" href="">اضافة </a>

                </div>
            </div>
        </div>
    </div>
</div>


<!-- Page Header Start -->
<div class="container-fluid bg-light">
    <div class="container">

        @if (TempData["WarningMessage"] != null)
        {
            <div style="background-color: #fff3cd; color: #856404; border: 1px solid #ffeeba; padding: 12px; margin-bottom: 20px; border-radius: 6px; font-size: 16px;">
                @TempData["WarningMessage"]
            </div>
        }


        <form asp-controller="DataEntry" id="myForm" asp-action="Index" method="post" enctype="multipart/form-data">
            <input name="WebsitetypeID" id="WebsitetypeID" type="hidden" value=@(ViewBag.ID ?? "Not specified") />
            @if (ViewBag.ID != 9 && ViewBag.ID != 12)
            {
                <div class="row">
                    <label>@ViewBag.TitleAr</label>
                    <input name="TitleAr" type="text" class="form-control p-4" data-validation-required-message="برجاء ادخال الاسم" aria-invalid="false">
                    <p class="help-block text-danger"></p>
                </div>
                <br />

            }
            @if ( ViewBag.ID == 12)
            {
                <div class="row">
                    <label>الاسم  باللغة الانجليزية</label>
                    <input name="TitleEn" type="text" class="form-control p-4" data-validation-required-message="برجاء ادخال الاسم" aria-invalid="false">
                    <p class="help-block text-danger"></p>
                </div>
                <br />

            }
            @if (ViewBag.ID == 7 || ViewBag.ID == 8 || ViewBag.ID == 10 || ViewBag.ID == 11 || ViewBag.ID == 12)
            {
                <div class="row">
                    <label>@ViewBag.descAr</label>
                    <textarea name="descAr" rows="3" class="form-control p-4" autocomplete="off"></textarea>
                    <p class="help-block text-danger"></p>
                </div>
                <br />
            }
            @if ( ViewBag.ID == 12)
            {
                <div class="row">
                    <label>@ViewBag.descEn</label>
                    <textarea name="descEn" rows="3" class="form-control p-4" autocomplete="off"></textarea>
                    <p class="help-block text-danger"></p>
                </div>
                <br />
            }
            @if (ViewBag.ID == 7 || ViewBag.ID == 8 || ViewBag.ID == 10)
            {
                <div class="row">
                    <label>@ViewBag.Date</label>
                    <input name="Date" type="date" class="form-control p-4" autocomplete="off" />
                    <p class="help-block text-danger"></p>
                </div>
                <br />
            }
            @if (ViewBag.ID != 8 && ViewBag.ID != 15 && ViewBag.ID != 16 && ViewBag.ID != 12)
            {
                <div class="row">
                    <label>@ViewBag.filepath</label>
                    <input name="imageFile" type="file" class="form-control">
                    <p class="help-block text-danger"></p>
                </div>
                <br />
            }
            @if (ViewBag.ID == 7 || ViewBag.ID == 8 || ViewBag.ID == 15 || ViewBag.ID == 16 || ViewBag.ID == 12)
            {
                <div class="row">
                    <label>الرابط الإلكتروني</label>
                    <input name="linkURL" type="text" class="form-control p-4" autocomplete="off" />
                    <p class="help-block text-danger"></p>
                </div>
                <br />
            }
            <div>
                <button class="btn btn-primary py-3 px-5" type="submit">حفظ</button>
            </div>

        </form>
        <div id="div2">
            <table class="table table-bordered table-striped table-hover">
                <thead class="bg-primary text-white">
                    <tr>
                        @if (ViewBag.ID != 9 && ViewBag.ID != 12)
                        {
                            <th>@ViewBag.TitleAr</th>
                        }
                        @if ( ViewBag.ID == 12)
                        {
                            <th>@ViewBag.TitleEn</th>
                        }
                        @if (ViewBag.ID == 7 || ViewBag.ID == 8 || ViewBag.ID == 10 || ViewBag.ID == 11 || ViewBag.ID == 12)
                        {
                            <th> تفاصيل عربي </th>
                        }
                        @if (ViewBag.ID == 7 || ViewBag.ID == 12)
                        {
                            <th> تفاصيل انجليزي </th>
                        }
                        @if (ViewBag.ID == 7 || ViewBag.ID == 8 || ViewBag.ID == 10)
                        {
                            <th> التاريخ </th>
                        }
                        @if (ViewBag.ID != 8 && ViewBag.ID != 15 && ViewBag.ID != 16 && ViewBag.ID != 12)
                        {
                            <th> الصورة  </th>
                        }
                        @if (ViewBag.ID == 7 || ViewBag.ID == 8 || ViewBag.ID == 15 || ViewBag.ID == 16 || ViewBag.ID == 12)
                        {
                            <th> الرابط </th>
                        }
                        <th> الاجراءات </th>

                    </tr>
                </thead>
                <tbody>
                    @if (Model != null)
                    {
                        @foreach (var item in Model)
                        {

                            <tr>
                                @if (ViewBag.ID != 9 && ViewBag.ID != 12)
                                {
                                    <td> @item.TitleAr </td>
                                }

                                @if (ViewBag.ID == 7 || ViewBag.ID == 12)
                                {
                                    <td> @item.TitleEn </td>
                                }

                                @if (ViewBag.ID == 7 || ViewBag.ID == 8 || ViewBag.ID == 10 || ViewBag.ID == 11 || ViewBag.ID == 12)
                                {
                                    <td> @item.descAr </td>
                                }

                                @if (ViewBag.ID == 7 || ViewBag.ID == 12)
                                {
                                    <td> @item.descEn </td>
                                }

                                @if (ViewBag.ID == 7 || ViewBag.ID == 8 || ViewBag.ID == 10)
                                {
                                    <td>
                                        @if (@item.Date != null)
                                        {
                                            @item.Date.Value.ToString("yyyy-MM-dd")
                                        }
                                    </td>
                                }

                                @if (ViewBag.ID != 8 && ViewBag.ID != 15 && ViewBag.ID != 16 && ViewBag.ID != 12)
                                {

                                    <td>
                                        @if (!string.IsNullOrEmpty(item.filepath))
                                        {
                                            if (item.filepath != null && (item.filepath.EndsWith(".pdf")))
                                            {
                                                <div class="ag-format-container col-md-12">
                                                    <div class="ag-courses_box">
                                                        <div class="ag-courses_item">
                                                            <a href="#" class="ag-courses-item_link openPdf" data-pdf="@item.filepath">
                                                                <div class="ag-courses-item_bg"></div>
                                                                <div class="ag-courses-item_title">
                                                                    <img src="~/img/pdf3.png" />
                                                                    <span>@item.TitleAr</span>
                                                                </div>
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            }
                                            @if (item.filepath != null &&
                                                                        (item.filepath.EndsWith(".jpg", StringComparison.OrdinalIgnoreCase) ||
                                                                        item.filepath.EndsWith(".jpeg", StringComparison.OrdinalIgnoreCase) ||
                                                                        item.filepath.EndsWith(".png", StringComparison.OrdinalIgnoreCase) ||
                                                                        item.filepath.EndsWith(".gif", StringComparison.OrdinalIgnoreCase) ||
                                                                        item.filepath.EndsWith(".webp", StringComparison.OrdinalIgnoreCase) ||
                                                                        item.filepath.EndsWith(".bmp", StringComparison.OrdinalIgnoreCase)))
                                            {
                                                <img src="@item.filepath" alt="Image" style="max-width: 100px; max-height: 60px;" class="img-thumbnail" />
                                            }
                                        }
                                        
                                    </td>
                                }

                                @if (ViewBag.ID == 7 || ViewBag.ID == 8 || ViewBag.ID == 15 || ViewBag.ID == 16 || ViewBag.ID == 12)
                                {
                                    <td>
                                        @if (!string.IsNullOrEmpty(item.linkURL))
                                        {
                                            <a href="@item.linkURL"> فتح الرابط </a>
                                        }
                                        else
                                        {
                                            <span> لا يوجد رابط</span>
                                        }
                                    </td>
                                }

                                <td>

                                    <div class="btn-group">

                                        <a href="@Url.Action("Edit", new { id = item.ID, IdType = ViewBag.ID })"
                                           class="btn btn-sm btn-warning">

                                            <i class="fas fa-edit"></i> تعديل
                                        </a>

                                        <a href="@Url.Action("Delete", "DataEntry", new { id = item.ID })"
                                           class="btn btn-sm btn-danger"
                                           onclick="return confirm('هل أنت متأكد من الحذف؟');">

                                            <i class="fas fa-trash"></i> حذف
                                        </a>

                                    </div>

                                </td>
                            </tr>
                        }
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>
@* /////////////////pdf//////////////////////// *@
<div id="pdfModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); z-index:9999;">
    <span id="closeModal" style="position:absolute; top:20px; right:30px; cursor:pointer; color:white; font-size:28px;">✖</span>
    <iframe id="pdfFrame" style="width:80%; height:80%; margin:50px auto; display:block; border:none;"></iframe>
</div>
<script>
    const modal = document.getElementById("pdfModal");
    const frame = document.getElementById("pdfFrame");
    const closeBtn = document.getElementById("closeModal");

    document.querySelectorAll(".openPdf").forEach(link => {
        link.addEventListener("click", function (e) {
            e.preventDefault();
            const pdfUrl = this.getAttribute("data-pdf");
            // alert(pdfUrl);
            frame.src = pdfUrl;
            modal.style.display = "block";
        });
    });

    closeBtn.onclick = function () {
        modal.style.display = "none";
        frame.src = "";
    };
</script>